<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>USMC Convoy Manifest Tool</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background-color: #f4f4f4; text-align: center; height: 100vh; overflow: hidden; }
        #splash { background-color: white; height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        #splash img { max-width: 300px; width: 80%; }
        #app { display: none; height: 100vh; overflow-y: auto; }
        h1 { color: #013220; }
        .screen { padding: 20px; max-width: 800px; margin: 0 auto; background: white; min-height: 100%; }
        button { background-color: #013220; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background-color: #024930; }
        button:disabled { background-color: #666; cursor: not-allowed; }
        input, select { width: 100%; padding: 8px; margin: 5px 0; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        label { display: block; margin: 5px 0; font-weight: bold; }
        .search-container { display: flex; align-items: center; margin-bottom: 20px; }
        #comm-search { flex: 1; }
        #add-search-btn { margin-left: 10px; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #013220; color: white; }
        #comm-gear-added { max-height: 400px; overflow-y: auto; }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div id="splash">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e7/Eagle%2C_Globe%2C_and_Anchor.svg/512px-Eagle%2C_Globe%2C_and_Anchor.svg.png" alt="USMC EGA">
        <h1>USMC Convoy Manifest Tool</h1>
        <p>Developed by [Your Name]</p>
    </div>

    <!-- Main App -->
    <div id="app">
        <!-- Initial Screen -->
        <div id="initial-screen" class="screen">
            <h1>Welcome to the USMC Convoy Manifest Tool</h1>
            <button id="new-user-btn">New User</button>
            <button id="returning-user-btn" disabled>Returning User</button>
        </div>

        <!-- New User Registration -->
        <div id="new-user-screen" class="screen" style="display: none;">
            <h1>New User Registration</h1>
            <form id="user-form">
                <label for="rank">Rank:</label>
                <input type="text" id="rank" name="rank" required>
                <label for="last-name">Last Name:</label>
                <input type="text" id="last-name" name="last-name" required>
                <label for="first-name">First Name:</label>
                <input type="text" id="first-name" name="first-name" required>
                <label for="billet">Billet:</label>
                <input type="text" id="billet" name="billet" required>
                <label for="unit">Unit:</label>
                <input type="text" id="unit" name="unit" required>
                <button type="submit">Submit</button>
            </form>
        </div>

        <!-- Options Screen -->
        <div id="options-screen" class="screen" style="display: none;">
            <h1>Convoy Management Options</h1>
            <button id="enter-vehicles-btn">Enter New Vehicles</button>
            <button id="enter-personnel-btn">Enter New Personnel</button>
            <button id="back-to-initial-btn">Back</button>
        </div>

        <!-- Enter Vehicles Screen -->
        <div id="vehicles-screen" class="screen" style="display: none;">
            <h1>Enter New Vehicles</h1>
            <button id="manual-add-btn">Manual Add</button>
            <button id="upload-spreadsheet-btn">Upload Spreadsheet</button>
            <button id="back-to-options-btn">Back</button>
        </div>

        <!-- Manual Add Screen -->
        <div id="manual-add-screen" class="screen" style="display: none;">
            <h1>Manual Add Equipment</h1>
            <button id="add-comm-gear-btn">Add Comm Gear</button>
            <button id="add-engineering-btn">Add Engineering Equipment</button>
            <button id="add-vehicles-btn">Add Vehicles</button>
            <button id="add-weapons-btn">Add Weapons Systems</button>
            <button id="back-to-vehicles-btn">Back</button>
        </div>

        <!-- Add Comm Gear Screen (Input Style 2) -->
        <div id="add-comm-gear-screen" class="screen" style="display: none;">
            <h1>Add Comm Gear (Input Style 2)</h1>
            <div class="search-container">
                <input type="text" id="comm-search" placeholder="Search by TAMCN or Name" list="comm-suggestions">
                <datalist id="comm-suggestions"></datalist>
                <button id="add-search-btn">Add</button>
            </div>
            <table id="comm-gear-table">
                <thead>
                    <tr>
                        <th>TAMCN</th>
                        <th>Name</th>
                        <th>Serial Number</th>
                    </tr>
                </thead>
                <tbody id="comm-gear-added"></tbody>
            </table>
            <button id="save-comm-gear-btn">Save</button>
            <button id="back-to-manual-add-btn">Back</button>
        </div>
    </div>

    <script>
        // Comm gear data from your spreadsheet
        const commGearData = {
            "A00227G": "JOINT BATTLE COMMAND-PLATFORM (JBC-P) INTERMEDIATE VEHICLE MOUNTED SYSTEM (VMS)",
            "A00617G": "TACT ELEVATED ANTENNA MAST SYS (TEAMS)",
            "A00677G": "HIGH FREQUENCY VEHICLE SYSTEM",
            "A00732B": "CHARGER, ADVANCED BATTERY",
            "A00977G": "RADIO SET, DUAL VEHICLE ADAPTER, 50-WATT (DVA)",
            "A01187G": "RADIO SET, INTEGRATED INTRA-SQUAD",
            "A01197G": "MARINE ANALOG TACTICAL TELEPHONE",
            "A01267G": "MULTI-BAND FREQUENCY, VEHICLE MOUNTED RADIO SYSTEM",
            "A01397G": "RADIO SET",
            "A01737G": "COMM SECURITY MODULE (CSM)",
            "A01747G": "LAN SERVICE MODULE (LSM)",
            "A01757G": "COMPUTER DIGITAL DATA TRANSFER",
            "A01767G": "LAN EXTENSION MODULE",
            "A01777G": "APPLICATION SERVER MODULE(ASM)",
            "A01987G": "RADIO SET, HIGH FREQUENCY, MANPACK SYSTEM",
            "A02057G": "RADIO SET, MULTICHANNEL MANPACK (MCMP) SYSTEM",
            "A02067G": "MULTICHANNEL MANPACK MULTICHANNEL MANPACK (MCMP) VEHICULAR SYSTEM SINGLE RT DUAL AMP",
            "A02077G": "RADIO SET, MULTICHANNEL HANDHELD (MCHH) SYSTEM",
            "A02087G": "RADIO SET, MULTICHANNEL HANDHELD (MCHH) VEHICLE SYSTEM",
            "A02107G": "ANTENNA GROUP",
            "A02117G": "ANTENNA GROUP",
            "A02347G": "VERY SMALL APERTURE TERMINAL - SMALL (VSAT-S)",
            "A02727G": "RADIO REMOTE CONTROL UNIT",
            "A02757G": "SURVEILLANCE, PERSISTENT OBSERVATION, AND TARGET RECOGNITION (SPOTR)",
            "A02987G": "HANDHELD SCANNER",
            "A03007G": "PM-4I PRINTER LABEL (TDIS)",
            "A03007GB": "PRINTER BARCODE LABEL DESKTOP (TDIS)",
            "A03127G": "WAN SERVICES MODULE (WSM) V2",
            "A03317G": "RADIO SET, LOW PROFILE SINGLE VEHICLE ADAPTER, 50-WATT",
            "A03367G": "SCA MULTIBAND NETWORKING RADIO",
            "A03517G": "RF-7800R-RC-110",
            "A03527G": "SCA MULTIBAND NETWORKING VEHICULAR RADIO SYSTEM - SINGLE MOUNT (RF-300M-V150)",
            "A03567G": "PLOTTER ALL-IN-ONE, EXPEDITIONARY",
            "A04147G": "SMALL UNIT REMOTE SCOUTING SYSTEM (SURSS), PUMA SUAS",
            "A08747G": "IAS TIER III INTELLIGENCE WORKSTATION (IW)",
            "A12607G": "NAVIGATION SET, SATELLITE SIGNALS",
            "A12607GK": "NAVIGATION SET, SATELLITE SIGNALS",
            "A12607GL": "NAVIGATION SET, SATELLITE SIGNALS",
            "A20427G": "RADIO SET, HIGH FREQUENCY, MANPACK",
            "A20687G": "RADIO SET, MULTIBAND, FALCON II",
            "A70007G": "MICROWAVE ANALYZER",
            "A70027G": "ANALYZER, SPECTRUM HAND HELD",
            "A70027GE": "HAND HELD 20GHZ SPECTRUM ANALYZER",
            "A70517G": "METER, POWER",
            "A70807G": "HAND HELD 1GHZ RADIO TEST SET",
            "A70867G": "OPTICAL TIME DOMAIN REFLECTOMETER (OTDR)",
            "A75022H": "WIRELESS AT-PLATFORM TEST SET (WATS)",
            "A75047G": "EMSS ELECTRONIC MAINTENANCE DEVICE",
            "A75057H": "HAND HELD RADIO TEST SET",
            "A77067G": "POWER SUPPLY",
            "A80017GA": "KGV 72",
            "A80047GA": "KSV 21",
            "A80067GC": "KG-250XS",
            "A80107G": "TERMINAL EQUIPMENT, TELEPHONE, SECURE",
            "A80237G": "TRANSFER DEVICE, DATA",
            "A80847GB": "ENCRYPTION-DECRYPTION KIV-7M",
            "A80887G": "ENCRYPTOR, NETWORK, IN-LINE",
            "A80887GB": "ENCRYPTOR, NETWORK, IN-LINE",
            "A90122G": "FIELD SERVICE STATION",
            "A90157G": "THEATRE MEDICAL INFORMATION PROGRAM CLIENT",
            "A90207G": "MCHS TABLET RUGGED",
            "A90237GD": "LAPTOP, HIGH PERF DELL PREC 3571",
            "A90257GB": "MCHS DEPLOY SERVER",
            "A90897G": "TACTICAL OPERATIONS CENTER KIT",
            "A91007G": "COMPUTER, GP, LAPTOP",
            "A91007GL": "MCHS GP LAPTOP",
            "A91007GM": "MCHS 5TH GEN GP LAPTOP",
            "A91357G": "INTEGRATED COMPUTERIZED DEPLOYMENT SYSTEM (ICODES)"
        };

        // Screen management
        function showScreen(screenId) {
            document.querySelectorAll('#app .screen').forEach(screen => screen.style.display = 'none');
            document.getElementById(screenId).style.display = 'block';
        }

        // Splash screen transition
        setTimeout(() => {
            document.getElementById('splash').style.display = 'none';
            document.getElementById('app').style.display = 'block';
        }, 5000);

        // Check for existing data
        const userData = JSON.parse(localStorage.getItem('userData')) || {};
        const commGear = JSON.parse(localStorage.getItem('commGear')) || [];
        if (Object.keys(userData).length > 0 || commGear.length > 0) {
            document.getElementById('returning-user-btn').disabled = false;
        }

        // Initial screen buttons
        document.getElementById('new-user-btn').addEventListener('click', () => showScreen('new-user-screen'));
        document.getElementById('returning-user-btn').addEventListener('click', () => alert('Returning user functionality coming soon!'));

        // New user form submission
        document.getElementById('user-form').addEventListener('submit', (event) => {
            event.preventDefault();
            const user = {
                rank: document.getElementById('rank').value,
                lastName: document.getElementById('last-name').value,
                firstName: document.getElementById('first-name').value,
                billet: document.getElementById('billet').value,
                unit: document.getElementById('unit').value
            };
            localStorage.setItem('userData', JSON.stringify(user));
            showScreen('options-screen');
        });

        // Options screen buttons
        document.getElementById('enter-vehicles-btn').addEventListener('click', () => showScreen('vehicles-screen'));
        document.getElementById('enter-personnel-btn').addEventListener('click', () => alert('Personnel entry coming soon!'));
        document.getElementById('back-to-initial-btn').addEventListener('click', () => showScreen('initial-screen'));

        // Vehicles screen buttons
        document.getElementById('manual-add-btn').addEventListener('click', () => showScreen('manual-add-screen'));
        document.getElementById('upload-spreadsheet-btn').addEventListener('click', () => alert('Spreadsheet upload coming soon!'));
        document.getElementById('back-to-options-btn').addEventListener('click', () => showScreen('options-screen'));

        // Manual add screen buttons
        document.getElementById('add-comm-gear-btn').addEventListener('click', () => {
            showScreen('add-comm-gear-screen');
            loadCommGearRows();
        });
        document.getElementById('add-engineering-btn').addEventListener('click', () => alert('Add Engineering Equipment form coming soon!'));
        document.getElementById('add-vehicles-btn').addEventListener('click', () => alert('Add Vehicles form coming soon!'));
        document.getElementById('add-weapons-btn').addEventListener('click', () => alert('Add Weapons Systems form coming soon!'));
        document.getElementById('back-to-vehicles-btn').addEventListener('click', () => showScreen('vehicles-screen'));

        // Comm gear screen (Input Style 2) logic
        const searchInput = document.getElementById('comm-search');
        const suggestions = document.getElementById('comm-suggestions');
        const addedTable = document.getElementById('comm-gear-added');

        // Populate datalist with all TAMCNs and Names
        Object.entries(commGearData).forEach(([tamcn, name]) => {
            suggestions.innerHTML += `<option value="${tamcn}">${name}</option>`;
            suggestions.innerHTML += `<option value="${name}">${tamcn}</option>`;
        });

        // Add button logic
        document.getElementById('add-search-btn').addEventListener('click', () => {
            const query = searchInput.value.trim().toUpperCase();
            let tamcn, name;
            if (commGearData[query]) {
                tamcn = query;
                name = commGearData[query];
            } else {
                tamcn = Object.keys(commGearData).find(t => commGearData[t].toUpperCase() === query);
                name = tamcn ? commGearData[tamcn] : null;
            }
            if (tamcn && name) {
                addedTable.appendChild(createCommGearRow(tamcn, name));
                searchInput.value = ''; // Clear search
            } else {
                alert('No matching item found. Please refine your search.');
            }
        });

        function createCommGearRow(tamcn, name, serial = '') {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${tamcn}</td>
                <td>${name}</td>
                <td><input type="text" class="serial-input" value="${serial}" placeholder="Enter Serial Number" required></td>
            `;
            return row;
        }

        function loadCommGearRows() {
            addedTable.innerHTML = '';
            const savedGear = JSON.parse(localStorage.getItem('commGear')) || [];
            savedGear.forEach(gear => addedTable.appendChild(createCommGearRow(gear.tamcn, gear.name, gear.serial)));
        }

        document.getElementById('save-comm-gear-btn').addEventListener('click', () => {
            const rows = addedTable.querySelectorAll('tr');
            const gearList = [];
            let allValid = true;
            rows.forEach(row => {
                const tamcn = row.cells[0].textContent;
                const name = row.cells[1].textContent;
                const serial = row.querySelector('.serial-input').value.trim();
                if (serial) {
                    gearList.push({ tamcn, name, serial });
                } else {
                    allValid = false;
                }
            });
            if (!allValid) {
                alert('Please enter serial numbers for all added items.');
            } else if (gearList.length > 0) {
                localStorage.setItem('commGear', JSON.stringify(gearList));
                alert('Comm Gear saved!');
                showScreen('manual-add-screen');
            } else {
                alert('No items to save.');
            }
        });

        document.getElementById('back-to-manual-add-btn').addEventListener('click', () => showScreen('manual-add-screen'));
    </script>
</body>
</html>
